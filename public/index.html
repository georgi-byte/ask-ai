<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ask AI</title>
  <style>
    :root {
      --bg: #f0f4f8;
      --bg2: #cfd9df;
      --container-bg: rgba(255,255,255,0.95);
      --text: #333;
      --chat-bg: #f9f9f9;
      --user-bg: #d1ecf1;
      --bot-bg: #ffffff;
      --bot-border: #ddd;
      --button-bg: #3498db;
      --button-hover: #2980b9;
      --tool-bg: #2ecc71;
      --tool-hover: #27ae60;
    }

    body.dark {
      --bg: #1e1e1e;
      --bg2: #121212;
      --container-bg: rgba(30,30,30,0.95);
      --text: #f1f1f1;
      --chat-bg: #2b2b2b;
      --user-bg: #34495e;
      --bot-bg: #3b3b3b;
      --bot-border: #555;
      --button-bg: #5555aa;
      --button-hover: #444499;
      --tool-bg: #228855;
      --tool-hover: #1b7045;
    }

    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, var(--bg), var(--bg2));
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      color: var(--text);
    }

    .container {
      background: var(--container-bg);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 95%;
      max-width: 500px;
    }

    h1 {
      text-align: center;
      color: var(--text);
      margin-bottom: 10px;
    }

    .chat-box {
      border: 1px solid #ccc;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
      border-radius: 8px;
      background: var(--chat-bg);
      margin-bottom: 10px;
    }

    .message {
      margin: 5px 0;
      padding: 8px 12px;
      border-radius: 8px;
      max-width: 75%;
      word-wrap: break-word;
      white-space: pre-wrap;
      color: var(--text);
    }

    .user { background: var(--user-bg); margin-left: auto; }
    .bot { background: var(--bot-bg); margin-right: auto; border: 1px solid var(--bot-border); }

    .row {
      display: flex;
      gap: 5px;
      margin-top: 5px;
    }

    input[type="text"] {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: var(--bot-bg);
      color: var(--text);
    }

    button {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      background: var(--button-bg);
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover { background: var(--button-hover); }

    .tools {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(100px,1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .tool-btn {
      background: var(--tool-bg);
      color: white;
      border: none;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      font-size: 14px;
    }
    .tool-btn:hover { background: var(--tool-hover); }

    .topbar {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <button id="languageToggleBtn">üåê Language: English</button>
      <button id="themeToggleBtn">üåì Dark Mode</button>
    </div>
    <h1 id="appTitle">Ask AI</h1>
    <div class="chat-box" id="chatBox"></div>

    <div class="row">
      <input type="text" id="userInput" placeholder="Ask me anything...">
      <button id="sendMessageBtn">Send</button>
    </div>

    <div class="tools">
      <button class="tool-btn" id="calcBtn">üßÆ Calculator</button>
      <button class="tool-btn" id="todoBtn">üìù To-Do</button>
      <button class="tool-btn" id="speakBtn">üé§ Talk</button>
    </div>
  </div>

<script>
const translations = {
  en: {appTitle:"Ask AI",language:"üåê Language: English",placeholder:"Ask me anything...",send:"Send",calc:"üßÆ Calculator",todo:"üìù To-Do",speak:"üé§ Talk",listening:"üé§ Listening... Speak now."},
  bg: {appTitle:"–ü–æ–ø–∏—Ç–∞–π AI",language:"üåê –ï–∑–∏–∫: –ë—ä–ª–≥–∞—Ä—Å–∫–∏",placeholder:"–ü–æ–ø–∏—Ç–∞–π –º–µ –Ω–µ—â–æ...",send:"–ò–∑–ø—Ä–∞—Ç–∏",calc:"üßÆ –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä",todo:"üìù –ó–∞–¥–∞—á–∏",speak:"üé§ –ì–æ–≤–æ—Ä–∏",listening:"üé§ –°–ª—É—à–∞–º... –ì–æ–≤–æ—Ä–∏ —Å–µ–≥–∞."},
  de: {appTitle:"Frag die KI",language:"üåê Sprache: Deutsch",placeholder:"Frag mich etwas...",send:"Senden",calc:"üßÆ Rechner",todo:"üìù Aufgaben",speak:"üé§ Sprechen",listening:"üé§ Ich h√∂re zu... Sprich jetzt."}
};
let currentLang='en';

const appTitle=document.getElementById('appTitle');
const languageToggleBtn=document.getElementById('languageToggleBtn');
const themeToggleBtn=document.getElementById('themeToggleBtn');
const userInput=document.getElementById('userInput');
const sendMessageBtn=document.getElementById('sendMessageBtn');
const calcBtn=document.getElementById('calcBtn');
const todoBtn=document.getElementById('todoBtn');
const speakBtn=document.getElementById('speakBtn');
const chatBox=document.getElementById('chatBox');

function updateLanguage(){
  const t=translations[currentLang];
  appTitle.textContent=t.appTitle;
  languageToggleBtn.textContent=t.language;
  userInput.placeholder=t.placeholder;
  sendMessageBtn.textContent=t.send;
  calcBtn.textContent=t.calc;
  todoBtn.textContent=t.todo;
  speakBtn.textContent=t.speak;
}
languageToggleBtn.addEventListener('click',()=>{currentLang=currentLang==='en'?'bg':currentLang==='bg'?'de':'en';updateLanguage();});
updateLanguage();

function appendMessage(text,type){
  const div=document.createElement('div');
  div.className=`message ${type}`;
  div.innerHTML=text.replace(/\n/g,'<br>');
  chatBox.appendChild(div);
  chatBox.scrollTop=chatBox.scrollHeight;
}
userInput.addEventListener('keydown',e=>{if(e.key==='Enter')sendMessageBtn.click();});

sendMessageBtn.addEventListener('click',async()=>{
  const msg=userInput.value.trim();if(!msg)return;
  appendMessage(msg,'user');userInput.value='';
  try{
    const res=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:msg,language:currentLang})});
    const data=await res.json();appendMessage(data.reply,'bot');
  }catch{appendMessage("‚ö†Ô∏è AI is offline",'bot');}
});

speakBtn.addEventListener('click',()=>{
  if(!('webkitSpeechRecognition'in window)){appendMessage("‚ö†Ô∏è Browser does not support speech",'bot');return;}
  const recog=new webkitSpeechRecognition();
  recog.lang=currentLang==='en'?'en-US':currentLang==='bg'?'bg-BG':'de-DE';
  appendMessage(translations[currentLang].listening,'bot');
  recog.start();
  recog.onresult=e=>{const transcript=e.results[0][0].transcript;userInput.value=transcript;sendMessageBtn.click();};
});

calcBtn.addEventListener('click',()=>{
  const exp=prompt("Enter expression:");if(!exp)return;
  try{appendMessage("Result: "+eval(exp),'bot');}catch{appendMessage("Invalid expression.",'bot');}
});

todoBtn.addEventListener('click',()=>{
  const todo=prompt("Enter a task:");if(!todo)return;appendMessage("üìù "+todo,'bot');
});

// üåô Theme toggle
if(localStorage.getItem('theme')==='dark') document.body.classList.add('dark');
themeToggleBtn.addEventListener('click',()=>{
  document.body.classList.toggle('dark');
  localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
});
</script>
</body>
</html>
