<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ask AI Assistant</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #e3f2fd, #bbdefb);
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      color: #333;
    }
    .container {
      width: 95%;
      max-width: 600px;
      background: #ffffffee;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      margin: 20px 0;
    }
    h1 {
      text-align: center;
      color: #1565c0;
      margin-bottom: 10px;
    }
    .tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    .tab {
      flex: 1;
      padding: 10px;
      text-align: center;
      background: #e3f2fd;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .tab.active {
      background: #1565c0;
      color: white;
    }
    .panel {
      display: none;
    }
    .panel.active {
      display: block;
    }
    .chat-box {
      border: 1px solid #ccc;
      border-radius: 8px;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
      background: #f5f5f5;
      margin-bottom: 10px;
    }
    .message {
      margin: 5px 0;
      padding: 8px 10px;
      border-radius: 6px;
      max-width: 75%;
      word-wrap: break-word;
    }
    .user { background: #bbdefb; margin-left: auto; text-align: right; }
    .bot { background: #fff; border: 1px solid #ccc; margin-right: auto; text-align: left; }
    input, button {
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 3px 0;
    }
    button {
      background: #1565c0;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background: #0d47a1;
    }
    .row { display: flex; gap: 5px; }
    .row input { flex: 1; }
    ul { padding: 0; list-style: none; }
    li { padding: 6px; background: #e3f2fd; border-radius: 5px; margin: 5px 0; display:flex; justify-content:space-between; align-items:center; }
    .delete-btn { background:#ef5350; border:none; color:white; border-radius:5px; padding:3px 8px; cursor:pointer; }
    @media (max-width: 600px) {
      .container { width: 95%; }
      .row { flex-direction: column; }
      .chat-box { height: 250px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ask AI Assistant</h1>

    <div class="tabs">
      <div class="tab active" data-tab="chat">üí¨ Chat</div>
      <div class="tab" data-tab="todo">üìù To-Do</div>
      <div class="tab" data-tab="calc">üßÆ Calculator</div>
    </div>

    <!-- Chat Panel -->
    <div id="chat" class="panel active">
      <div class="chat-box" id="chatBox"></div>
      <div class="row">
        <input type="text" id="userInput" placeholder="Ask me anything...">
        <button id="sendBtn">Send</button>
      </div>
      <button id="speakBtn" style="width:100%;margin-top:5px;">üé§ Speak</button>
    </div>

    <!-- To-Do Panel -->
    <div id="todo" class="panel">
      <div class="row">
        <input type="text" id="todoInput" placeholder="Add a task">
        <button id="addTodo">Add</button>
      </div>
      <ul id="todoList"></ul>
    </div>

    <!-- Calculator Panel -->
    <div id="calc" class="panel">
      <div class="row">
        <input type="text" id="calcInput" placeholder="e.g. 5+7*2">
        <button id="calcBtn">Calculate</button>
      </div>
      <div id="calcResult" style="margin-top:10px;font-weight:bold;"></div>
    </div>
  </div>

<script>
const tabs = document.querySelectorAll('.tab');
const panels = document.querySelectorAll('.panel');
tabs.forEach(t=>t.addEventListener('click',()=>{
  tabs.forEach(x=>x.classList.remove('active'));
  panels.forEach(p=>p.classList.remove('active'));
  t.classList.add('active');
  document.getElementById(t.dataset.tab).classList.add('active');
}));

// Chat
const chatBox = document.getElementById('chatBox');
const userInput = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');
function appendMessage(text,type='bot'){const div=document.createElement('div');div.className=`message ${type}`;div.textContent=text;chatBox.appendChild(div);chatBox.scrollTop=chatBox.scrollHeight;}
async function sendMsg(){
  const msg=userInput.value.trim();if(!msg)return;
  appendMessage(msg,'user');userInput.value='';
  try{
    const res=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:msg})});
    const data=await res.json();
    appendMessage(data.reply||"‚ö†Ô∏è No response",'bot');
  }catch{appendMessage("‚ö†Ô∏è AI is offline",'bot');}
}
sendBtn.onclick=sendMsg;
userInput.addEventListener('keypress',e=>{if(e.key==='Enter')sendMsg();});

// Speak (voice input)
document.getElementById('speakBtn').onclick=()=>{
  if(!('webkitSpeechRecognition'in window||'SpeechRecognition'in window))return appendMessage("‚ö†Ô∏è Voice not supported",'bot');
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  const rec=new SR();
  rec.lang='en-US'; rec.start();
  appendMessage("üé§ Listening...","bot");
  rec.onresult=e=>{
    const text=e.results[0][0].transcript;
    userInput.value=text; sendMsg();
  };
};

// To-Do
const todoInput=document.getElementById('todoInput');
const todoList=document.getElementById('todoList');
document.getElementById('addTodo').onclick=()=>{
  const task=todoInput.value.trim();if(!task)return;
  const li=document.createElement('li');
  li.innerHTML=`<span>${task}</span> <button class="delete-btn">‚úï</button>`;
  li.querySelector('button').onclick=()=>li.remove();
  todoList.appendChild(li);
  todoInput.value='';
};

// Calculator
document.getElementById('calcBtn').onclick=()=>{
  const expr=document.getElementById('calcInput').value;
  try{
    const result=eval(expr);
    document.getElementById('calcResult').textContent="Result: "+result;
  }catch{document.getElementById('calcResult').textContent="Invalid expression";}
};
</script>
</body>
</html>
