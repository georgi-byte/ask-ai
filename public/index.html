<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ask AI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #f0f4f8, #cfd9df);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      color: #333;
    }
    .container {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 95%;
      max-width: 500px;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 10px;
    }
    .chat-box {
      border: 1px solid #ccc;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
      border-radius: 8px;
      background: #f9f9f9;
      margin-bottom: 10px;
    }
    .message {
      margin: 5px 0;
      padding: 8px 12px;
      border-radius: 8px;
      max-width: 75%;
      word-wrap: break-word;
      white-space: pre-wrap;
    }
    .user { background: #d1ecf1; margin-left: auto; }
    .bot { background: #ffffff; margin-right: auto; border: 1px solid #ddd; }
    .row {
      display: flex;
      gap: 5px;
      margin-top: 5px;
    }
    input[type="text"] {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      background: #3498db;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover { background: #2980b9; }
    .tools {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(100px,1fr));
      gap: 10px;
      margin-top: 15px;
    }
    .tool-btn {
      background: #2ecc71;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      font-size: 14px;
    }
    .tool-btn:hover { background: #27ae60; }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="appTitle">Ask AI</h1>
    <button id="languageToggleBtn">üåê Language: English</button>
    <div class="chat-box" id="chatBox"></div>

    <div class="row">
      <input type="text" id="userInput" placeholder="Ask me anything...">
      <button id="sendMessageBtn">Send</button>
    </div>

    <div class="tools">
      <button class="tool-btn" id="calcBtn">üßÆ Calculator</button>
      <button class="tool-btn" id="todoBtn">üìù To-Do</button>
      <button class="tool-btn" id="speakBtn">üé§ Talk</button>
    </div>
  </div>

<script>
const translations = {
  en: {appTitle:"Ask AI",language:"üåê Language: English",placeholder:"Ask me anything...",send:"Send",calc:"üßÆ Calculator",todo:"üìù To-Do",speak:"üé§ Talk",listening:"üé§ Listening... Speak now."},
  bg: {appTitle:"–ü–æ–ø–∏—Ç–∞–π AI",language:"üåê –ï–∑–∏–∫: –ë—ä–ª–≥–∞—Ä—Å–∫–∏",placeholder:"–ü–æ–ø–∏—Ç–∞–π –º–µ –Ω–µ—â–æ...",send:"–ò–∑–ø—Ä–∞—Ç–∏",calc:"üßÆ –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä",todo:"üìù –ó–∞–¥–∞—á–∏",speak:"üé§ –ì–æ–≤–æ—Ä–∏",listening:"üé§ –°–ª—É—à–∞–º... –ì–æ–≤–æ—Ä–∏ —Å–µ–≥–∞."},
  de: {appTitle:"Frag die KI",language:"üåê Sprache: Deutsch",placeholder:"Frag mich etwas...",send:"Senden",calc:"üßÆ Rechner",todo:"üìù Aufgaben",speak:"üé§ Sprechen",listening:"üé§ Ich h√∂re zu... Sprich jetzt."}
};
let currentLang='en';

const appTitle=document.getElementById('appTitle');
const languageToggleBtn=document.getElementById('languageToggleBtn');
const userInput=document.getElementById('userInput');
const sendMessageBtn=document.getElementById('sendMessageBtn');
const calcBtn=document.getElementById('calcBtn');
const todoBtn=document.getElementById('todoBtn');
const speakBtn=document.getElementById('speakBtn');
const chatBox=document.getElementById('chatBox');

function updateLanguage(){
  const t=translations[currentLang];
  appTitle.textContent=t.appTitle;
  languageToggleBtn.textContent=t.language;
  userInput.placeholder=t.placeholder;
  sendMessageBtn.textContent=t.send;
  calcBtn.textContent=t.calc;
  todoBtn.textContent=t.todo;
  speakBtn.textContent=t.speak;
}
languageToggleBtn.addEventListener('click',()=>{currentLang=currentLang==='en'?'bg':currentLang==='bg'?'de':'en';updateLanguage();});
updateLanguage();

function appendMessage(text,type){
  const div=document.createElement('div');
  div.className=`message ${type}`;
  div.innerHTML=text.replace(/\n/g,'<br>');
  chatBox.appendChild(div);
  chatBox.scrollTop=chatBox.scrollHeight;
}

userInput.addEventListener('keydown',e=>{if(e.key==='Enter')sendMessageBtn.click();});

sendMessageBtn.addEventListener('click',async()=>{
  const msg=userInput.value.trim();if(!msg)return;
  appendMessage(msg,'user');userInput.value='';
  try{
    const res=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:msg,language:currentLang})});
    const data=await res.json();appendMessage(data.reply,'bot');
  }catch{appendMessage("‚ö†Ô∏è AI is offline",'bot');}
});

speakBtn.addEventListener('click',()=>{
  if(!('webkitSpeechRecognition'in window)){appendMessage("‚ö†Ô∏è Browser does not support speech",'bot');return;}
  const recog=new webkitSpeechRecognition();
  recog.lang=currentLang==='en'?'en-US':currentLang==='bg'?'bg-BG':'de-DE';
  appendMessage(translations[currentLang].listening,'bot');
  recog.start();
  recog.onresult=e=>{const transcript=e.results[0][0].transcript;userInput.value=transcript;sendMessageBtn.click();};
});

calcBtn.addEventListener('click',()=>{
  const exp=prompt("Enter expression:");if(!exp)return;
  try{appendMessage("Result: "+eval(exp),'bot');}catch{appendMessage("Invalid expression.",'bot');}
});

todoBtn.addEventListener('click',()=>{
  const todo=prompt("Enter a task:");if(!todo)return;appendMessage("üìù "+todo,'bot');
});
</script>
</body>
</html>
